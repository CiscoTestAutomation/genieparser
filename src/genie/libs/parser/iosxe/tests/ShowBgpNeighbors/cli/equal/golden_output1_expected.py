expected_output = {
    "list_of_neighbors": ["10.1.1.1", "10.2.2.2"],
    "vrf": {
        "default": {
            "neighbor": {
                "10.1.1.1": {
                    "address_family": {
                        "ipv4 unicast": {
                            "advertise_bit": 0,
                            "bgp_table_version": 1,
                            "dynamic_slow_peer_recovered": "never",
                            "index": 1,
                            "last_detected_dynamic_slow_peer": "never",
                            "last_received_refresh_end_of_rib": "never",
                            "last_received_refresh_start_of_rib": "never",
                            "last_sent_refresh_end_of_rib": "never",
                            "last_sent_refresh_start_of_rib": "never",
                            "local_policy_denied_prefixes_counters": {
                                "inbound": {"total": 0},
                                "outbound": {"total": 0},
                            },
                            "max_nlri": 0,
                            "min_nlri": 0,
                            "neighbor_version": "1/0",
                            "output_queue_size": 0,
                            "prefix_activity_counters": {
                                "received": {
                                    "explicit_withdraw": 0,
                                    "implicit_withdraw": 0,
                                    "prefixes_current": 0,
                                    "prefixes_total": 0,
                                    "used_as_bestpath": 0,
                                    "used_as_multipath": 0,
                                    "used_as_secondary": 0,
                                },
                                "sent": {
                                    "explicit_withdraw": 0,
                                    "implicit_withdraw": 0,
                                    "prefixes_current": 0,
                                    "prefixes_total": 0,
                                    "used_as_bestpath": "n/a",
                                    "used_as_multipath": "n/a",
                                    "used_as_secondary": "n/a",
                                },
                            },
                            "refresh_activity_counters": {
                                "received": {
                                    "refresh_end_of_rib": 0,
                                    "refresh_start_of_rib": 0,
                                },
                                "sent": {
                                    "refresh_end_of_rib": 0,
                                    "refresh_start_of_rib": 0,
                                },
                            },
                            "refresh_epoch": 1,
                            "slow_peer_detection": False,
                            "slow_peer_split_update_group_dynamic": False,
                            "update_group_member": 1,
                        },
                        "vpnv4 unicast": {
                            "advertise_bit": 1,
                            "bgp_table_version": 21,
                            "current_time": "0x13F885E6",
                            "dynamic_slow_peer_recovered": "never",
                            "extended_community_attribute_sent": True,
                            "index": 3,
                            "last_detected_dynamic_slow_peer": "never",
                            "last_received_refresh_end_of_rib": "never",
                            "last_received_refresh_start_of_rib": "never",
                            "last_sent_refresh_end_of_rib": "never",
                            "last_sent_refresh_start_of_rib": "never",
                            "local_policy_denied_prefixes_counters": {
                                "inbound": {
                                    "af_permit_check": "n/a",
                                    "bestpath_from_ibgp_peer": "n/a",
                                    "bestpath_from_this_peer": "n/a",
                                    "originator_loop": 8,
                                    "total": 8,
                                },
                                "outbound": {
                                    "af_permit_check": 4,
                                    "bestpath_from_ibgp_peer": 4,
                                    "bestpath_from_this_peer": 4,
                                    "originator_loop": "n/a",
                                    "total": 12,
                                },
                            },
                            "max_nlri": 1,
                            "min_nlri": 0,
                            "neighbor_version": "21/0",
                            "output_queue_size": 0,
                            "prefix_activity_counters": {
                                "received": {
                                    "explicit_withdraw": 0,
                                    "implicit_withdraw": 0,
                                    "prefixes_current": 4,
                                    "prefixes_total": 4,
                                    "used_as_bestpath": 4,
                                    "used_as_multipath": 0,
                                    "used_as_secondary": 0,
                                },
                                "sent": {
                                    "explicit_withdraw": 0,
                                    "implicit_withdraw": 4,
                                    "prefixes_current": 4,
                                    "prefixes_total": 8,
                                    "used_as_bestpath": "n/a",
                                    "used_as_multipath": "n/a",
                                    "used_as_secondary": "n/a",
                                },
                            },
                            "refresh_activity_counters": {
                                "received": {
                                    "refresh_end_of_rib": 0,
                                    "refresh_start_of_rib": 0,
                                },
                                "sent": {
                                    "refresh_end_of_rib": 0,
                                    "refresh_start_of_rib": 0,
                                },
                            },
                            "refresh_epoch": 1,
                            "slow_peer_detection": False,
                            "slow_peer_split_update_group_dynamic": False,
                            "update_group_member": 3,
                        },
                    },
                    "bgp_event_timer": {
                        "next": {
                            "ackhold": "0x0",
                            "deadwait": "0x0",
                            "giveup": "0x0",
                            "keepalive": "0x0",
                            "linger": "0x0",
                            "pmtuager": "0x0",
                            "processq": "0x0",
                            "retrans": "0x0",
                            "sendwnd": "0x0",
                            "timewait": "0x0",
                        },
                        "starts": {
                            "ackhold": 6150,
                            "deadwait": 0,
                            "giveup": 0,
                            "keepalive": 0,
                            "linger": 0,
                            "pmtuager": 0,
                            "processq": 0,
                            "retrans": 6150,
                            "sendwnd": 0,
                            "timewait": 0,
                        },
                        "wakeups": {
                            "ackhold": 6008,
                            "deadwait": 0,
                            "giveup": 0,
                            "keepalive": 0,
                            "linger": 0,
                            "pmtuager": 0,
                            "processq": 0,
                            "retrans": 0,
                            "sendwnd": 0,
                            "timewait": 0,
                        },
                    },
                    "bgp_neighbor_session": {"sessions": 1},
                    "bgp_negotiated_capabilities": {
                        "enhanced_refresh": "advertised and received",
                        "four_octets_asn": "advertised and received",
                        "ipv4_unicast": "advertised and received",
                        "route_refresh": "advertised and received(new)",
                        "stateful_switchover": "NO for session 1",
                        "vpnv4_unicast": "advertised and received",
                    },
                    "bgp_negotiated_keepalive_timers": {
                        "hold_time": 180,
                        "keepalive_interval": 60,
                    },
                    "bgp_neighbor_counters": {
                        "messages": {
                            "in_queue_depth": 0,
                            "out_queue_depth": 0,
                            "received": {
                                "keepalives": 6147,
                                "notifications": 0,
                                "opens": 1,
                                "route_refresh": 0,
                                "total": 6162,
                                "updates": 14,
                            },
                            "sent": {
                                "keepalives": 6146,
                                "notifications": 0,
                                "opens": 1,
                                "route_refresh": 0,
                                "total": 6157,
                                "updates": 10,
                            },
                        }
                    },
                    "bgp_session_transport": {
                        "ack_hold": 200,
                        "address_tracking_status": "enabled",
                        "connection": {
                            "dropped": 0,
                            "established": 1,
                            "last_reset": "never",
                        },
                        "connection_state": "estab",
                        "connection_tableid": 0,
                        "datagram": {
                            "datagram_received": {
                                "out_of_order": 0,
                                "total_data": 118194,
                                "value": 12281,
                                "with_data": 6151,
                            },
                            "datagram_sent": {
                                "fastretransmit": 0,
                                "partialack": 0,
                                "retransmit": 0,
                                "second_congestion": 0,
                                "total_data": 117635,
                                "value": 12246,
                                "with_data": 6151,
                            },
                        },
                        "delrcvwnd": 19,
                        "ecn_connection": "disabled",
                        "enqueued_packets": {
                            "input_packet": 0,
                            "mis_ordered_packet": 0,
                            "retransmit_packet": 0,
                        },
                        "fast_lock_acquisition_failures": 0,
                        "graceful_restart": "disabled",
                        "io_status": 1,
                        "ip_precedence_value": 6,
                        "irs": 547332975,
                        "iss": 3484933877,
                        "krtt": 0,
                        "lock_slow_path": 0,
                        "max_rtt": 1000,
                        "maximum_output_segment_queue_size": 50,
                        "maxrcvwnd": 16384,
                        "min_rtt": 1,
                        "min_time_between_advertisement_runs": 0,
                        "minimum_incoming_ttl": 0,
                        "option_flags": "nagle, path mtu capable",
                        "outgoing_ttl": 255,
                        "packet_fast_path": 0,
                        "packet_fast_processed": 0,
                        "packet_slow_path": 0,
                        "rcv_scale": 0,
                        "rcvnxt": 547451170,
                        "rcvwnd": 16365,
                        "receive_idletime": 33158,
                        "rib_route_ip": "10.1.1.1",
                        "rtto": 1003,
                        "rtv": 3,
                        "sent_idletime": 33361,
                        "snd_scale": 0,
                        "sndnxt": 3485051513,
                        "snduna": 3485051513,
                        "sndwnd": 15453,
                        "srtt": 1000,
                        "sso": False,
                        "status_flags": "passive open, gen tcbs",
                        "tcp_path_mtu_discovery": "enabled",
                        "tcp_semaphore": "0x7F59978AAB40",
                        "tcp_semaphore_status": "FREE",
                        "transport": {
                            "foreign_host": "10.1.1.1",
                            "foreign_port": "44730",
                            "local_host": "10.5.5.5",
                            "local_port": "179",
                            "mss": 1396,
                        },
                        "unread_input_bytes": 0,
                        "uptime": 334841877,
                    },
                    "bgp_version": 4,
                    "link": "internal",
                    "remote_as": 65000,
                    "router_id": "10.1.1.1",
                    "session_state": "Established",
                    "shutdown": False,
                },
                "10.2.2.2": {
                    "address_family": {
                        "ipv4 unicast": {
                            "advertise_bit": 0,
                            "bgp_table_version": 1,
                            "dynamic_slow_peer_recovered": "never",
                            "index": 1,
                            "last_detected_dynamic_slow_peer": "never",
                            "last_received_refresh_end_of_rib": "never",
                            "last_received_refresh_start_of_rib": "never",
                            "last_sent_refresh_end_of_rib": "never",
                            "last_sent_refresh_start_of_rib": "never",
                            "local_policy_denied_prefixes_counters": {
                                "inbound": {"total": 0},
                                "outbound": {"total": 0},
                            },
                            "max_nlri": 0,
                            "min_nlri": 0,
                            "neighbor_version": "1/0",
                            "output_queue_size": 0,
                            "prefix_activity_counters": {
                                "received": {
                                    "explicit_withdraw": 0,
                                    "implicit_withdraw": 0,
                                    "prefixes_current": 0,
                                    "prefixes_total": 0,
                                    "used_as_bestpath": 0,
                                    "used_as_multipath": 0,
                                    "used_as_secondary": 0,
                                },
                                "sent": {
                                    "explicit_withdraw": 0,
                                    "implicit_withdraw": 0,
                                    "prefixes_current": 0,
                                    "prefixes_total": 0,
                                    "used_as_bestpath": "n/a",
                                    "used_as_multipath": "n/a",
                                    "used_as_secondary": "n/a",
                                },
                            },
                            "refresh_activity_counters": {
                                "received": {
                                    "refresh_end_of_rib": 0,
                                    "refresh_start_of_rib": 0,
                                },
                                "sent": {
                                    "refresh_end_of_rib": 0,
                                    "refresh_start_of_rib": 0,
                                },
                            },
                            "refresh_epoch": 1,
                            "slow_peer_detection": False,
                            "slow_peer_split_update_group_dynamic": False,
                            "update_group_member": 1,
                        },
                        "vpnv4 unicast": {
                            "advertise_bit": 1,
                            "bgp_table_version": 21,
                            "current_time": "0x13F886BA",
                            "dynamic_slow_peer_recovered": "never",
                            "extended_community_attribute_sent": True,
                            "index": 3,
                            "last_detected_dynamic_slow_peer": "never",
                            "last_read": "00:00:04",
                            "last_received_refresh_end_of_rib": "never",
                            "last_received_refresh_start_of_rib": "never",
                            "last_sent_refresh_end_of_rib": "never",
                            "last_sent_refresh_start_of_rib": "never",
                            "last_write": "00:00:28",
                            "local_policy_denied_prefixes_counters": {
                                "inbound": {
                                    "af_permit_check": "n/a",
                                    "bestpath_from_ibgp_peer": "n/a",
                                    "bestpath_from_this_peer": "n/a",
                                    "originator_loop": 8,
                                    "total": 8,
                                },
                                "outbound": {
                                    "af_permit_check": 4,
                                    "bestpath_from_ibgp_peer": 4,
                                    "bestpath_from_this_peer": 4,
                                    "originator_loop": "n/a",
                                    "total": 12,
                                },
                            },
                            "max_nlri": 1,
                            "min_nlri": 0,
                            "neighbor_version": "21/0",
                            "output_queue_size": 0,
                            "prefix_activity_counters": {
                                "received": {
                                    "explicit_withdraw": 0,
                                    "implicit_withdraw": 0,
                                    "prefixes_current": 4,
                                    "prefixes_total": 4,
                                    "used_as_bestpath": 0,
                                    "used_as_multipath": 0,
                                    "used_as_secondary": 0,
                                },
                                "sent": {
                                    "explicit_withdraw": 0,
                                    "implicit_withdraw": 4,
                                    "prefixes_current": 4,
                                    "prefixes_total": 8,
                                    "used_as_bestpath": "n/a",
                                    "used_as_multipath": "n/a",
                                    "used_as_secondary": "n/a",
                                },
                            },
                            "refresh_activity_counters": {
                                "received": {
                                    "refresh_end_of_rib": 0,
                                    "refresh_start_of_rib": 0,
                                },
                                "sent": {
                                    "refresh_end_of_rib": 0,
                                    "refresh_start_of_rib": 0,
                                },
                            },
                            "refresh_epoch": 1,
                            "session_state": "Established",
                            "slow_peer_detection": False,
                            "slow_peer_split_update_group_dynamic": False,
                            "up_time": "3d21h",
                            "update_group_member": 3,
                        },
                    },
                    "bgp_event_timer": {
                        "next": {
                            "ackhold": "0x0",
                            "deadwait": "0x0",
                            "giveup": "0x0",
                            "keepalive": "0x0",
                            "linger": "0x0",
                            "pmtuager": "0x0",
                            "processq": "0x0",
                            "retrans": "0x0",
                            "sendwnd": "0x0",
                            "timewait": "0x0",
                        },
                        "starts": {
                            "ackhold": 6142,
                            "deadwait": 0,
                            "giveup": 0,
                            "keepalive": 0,
                            "linger": 0,
                            "pmtuager": 0,
                            "processq": 0,
                            "retrans": 6139,
                            "sendwnd": 0,
                            "timewait": 0,
                        },
                        "wakeups": {
                            "ackhold": 6023,
                            "deadwait": 0,
                            "giveup": 0,
                            "keepalive": 0,
                            "linger": 0,
                            "pmtuager": 0,
                            "processq": 0,
                            "retrans": 0,
                            "sendwnd": 0,
                            "timewait": 0,
                        },
                    },
                    "bgp_neighbor_session": {"sessions": 1},
                    "bgp_negotiated_capabilities": {
                        "enhanced_refresh": "advertised and received",
                        "four_octets_asn": "advertised and received",
                        "ipv4_unicast": "advertised and received",
                        "route_refresh": "advertised and received(new)",
                        "stateful_switchover": "NO for session 1",
                        "vpnv4_unicast": "advertised and received",
                    },
                    "bgp_negotiated_keepalive_timers": {
                        "hold_time": 180,
                        "keepalive_interval": 60,
                    },
                    "bgp_neighbor_counters": {
                        "messages": {
                            "in_queue_depth": 0,
                            "out_queue_depth": 0,
                            "received": {
                                "keepalives": 6139,
                                "notifications": 0,
                                "opens": 1,
                                "route_refresh": 0,
                                "total": 6154,
                                "updates": 14,
                            },
                            "sent": {
                                "keepalives": 6134,
                                "notifications": 0,
                                "opens": 1,
                                "route_refresh": 0,
                                "total": 6145,
                                "updates": 10,
                            },
                        }
                    },
                    "bgp_session_transport": {
                        "ack_hold": 200,
                        "address_tracking_status": "enabled",
                        "connection": {
                            "dropped": 0,
                            "established": 1,
                            "last_reset": "never",
                        },
                        "connection_state": "estab",
                        "connection_tableid": 0,
                        "datagram": {
                            "datagram_received": {
                                "out_of_order": 0,
                                "total_data": 118042,
                                "value": 12256,
                                "with_data": 6143,
                            },
                            "datagram_sent": {
                                "fastretransmit": 0,
                                "partialack": 0,
                                "retransmit": 0,
                                "second_congestion": 0,
                                "total_data": 117407,
                                "value": 12248,
                                "with_data": 6139,
                            },
                        },
                        "delrcvwnd": 1273,
                        "ecn_connection": "disabled",
                        "enqueued_packets": {
                            "input_packet": 0,
                            "mis_ordered_packet": 0,
                            "retransmit_packet": 0,
                        },
                        "fast_lock_acquisition_failures": 0,
                        "graceful_restart": "disabled",
                        "io_status": 1,
                        "ip_precedence_value": 6,
                        "irs": 2814267610,
                        "iss": 84959429,
                        "krtt": 0,
                        "lock_slow_path": 0,
                        "max_rtt": 1000,
                        "maximum_output_segment_queue_size": 50,
                        "maxrcvwnd": 16384,
                        "min_rtt": 1,
                        "min_time_between_advertisement_runs": 0,
                        "minimum_incoming_ttl": 0,
                        "option_flags": "nagle, path mtu capable",
                        "outgoing_ttl": 255,
                        "packet_fast_path": 0,
                        "packet_fast_processed": 0,
                        "packet_slow_path": 0,
                        "rcv_scale": 0,
                        "rcvnxt": 2814385653,
                        "rcvwnd": 15111,
                        "receive_idletime": 4619,
                        "rib_route_ip": "10.2.2.2",
                        "rtto": 1003,
                        "rtv": 3,
                        "sent_idletime": 4419,
                        "snd_scale": 0,
                        "sndnxt": 85076837,
                        "snduna": 85076837,
                        "sndwnd": 15681,
                        "srtt": 1000,
                        "sso": False,
                        "status_flags": "passive open, gen tcbs",
                        "tcp_path_mtu_discovery": "enabled",
                        "tcp_semaphore": "0x7F59978AAC10",
                        "tcp_semaphore_status": "FREE",
                        "transport": {
                            "foreign_host": "10.2.2.2",
                            "foreign_port": "43047",
                            "local_host": "10.5.5.5",
                            "local_port": "179",
                            "mss": 1396,
                        },
                        "unread_input_bytes": 0,
                        "uptime": 334847216,
                    },
                    "bgp_version": 4,
                    "link": "internal",
                    "remote_as": 65000,
                    "router_id": "10.2.2.2",
                    "session_state": "Established",
                    "shutdown": False,
                },
            }
        }
    },
}
